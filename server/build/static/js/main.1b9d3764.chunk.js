(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{125:function(e,t,n){},177:function(e,t,n){},178:function(e,t,n){"use strict";n.r(t);var a,r=n(2),c=n(0),s=n(10),i=n.n(s),o=(n(125),n(9)),u=n(222),l=n(29),j=n(12),d=n(110),b=Object(d.a)({typography:{fontFamily:'"Roboto"',fontSize:12},palette:{primary:{main:"#1976d2"},secondary:{main:"#fff",contrastText:"#1976d2"}}}),m=n(215),O=n(219),h=n(224),x=n(213),g=n.p+"static/media/bg-img.0c5628a9.png",f=Object(x.a)((function(e){return{root:{height:"100vh"},paper:{margin:e.spacing(10,8),display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"100%",marginTop:e.spacing(3)},image:{backgroundImage:"url(".concat(g,")"),backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center"},mainButton:{margin:e.spacing(3,0,2),padding:e.spacing(1,3)},secondaryButton:{margin:e.spacing(1,0,0),padding:e.spacing(1,2)},loginRegisterRedirect:{marginBottom:e.spacing(5),display:"flex",flexDirection:"horizontal",alignItems:"end",width:"100%"},loginRedirectText:{marginTop:e.spacing(2),color:"lightgrey"},backgroundImageText:{color:"white",marginLeft:"20%",marginRight:"20%"}}})),p=n(111),v=n(223),y=n(226),w=n(217),S=n(218),C=function(){var e=f(),t=Object(j.g)();return Object(r.jsx)("div",{className:e.loginRegisterRedirect,children:Object(r.jsxs)(m.a,{container:!0,justify:"flex-end",spacing:2,children:[Object(r.jsx)(m.a,{item:!0,children:Object(r.jsx)(w.a,{className:e.loginRedirectText,variant:"subtitle1",children:"Already have an account?"})}),Object(r.jsx)(m.a,{item:!0,children:Object(r.jsx)(S.a,{type:"button",variant:"contained",color:"secondary",size:"large",className:e.secondaryButton,onClick:function(){t.push("/login")},children:"Login"})})]})})},N=function(e){var t=e.createUser,n=Object(c.useState)(""),a=Object(o.a)(n,2),s=a[0],i=a[1],u=Object(c.useState)(""),l=Object(o.a)(u,2),j=l[0],d=l[1],b=Object(c.useState)(""),O=Object(o.a)(b,2),x=O[0],g=O[1],N=Object(c.useState)(""),k=Object(o.a)(N,2),T=k[0],I=k[1],z=Object(c.useState)(!1),B=Object(o.a)(z,2),R=B[0],U=B[1],D=Object(c.useState)({}),E=Object(o.a)(D,2),A=E[0],W=E[1],L=f(),P=function(e,t){"clickaway"!==t&&U(!1)};return Object(r.jsxs)("div",{className:L.paper,children:[Object(r.jsx)(C,{}),Object(r.jsx)(m.a,{container:!0,alignContent:"flex-start",children:Object(r.jsx)(w.a,{component:"h1",variant:"h5",children:"Create an account."})}),Object(r.jsx)("div",{children:Object(r.jsxs)("form",{className:L.form,onSubmit:function(e){e.preventDefault(),!function(){var e={};return e.username=s.length>2?"":"Minimum of 3 characters",e.password=x.length>5?"":"Minimum of 6 characters",e.email=/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9]+\.[A-Za-z]+$/.test(T)?"":"Email Format is xyz@xxx.xxx",W(Object(p.a)({},e)),Object.values(e).every((function(e){return""===e}))}()?U(!0):(t({username:s,name:j,email:T,password:x}),U(!1),i(""),d(""),I(""),g(""))},children:[Object(r.jsxs)(m.a,{container:!0,spacing:2,children:[Object(r.jsx)(m.a,{item:!0,xs:12,children:Object(r.jsx)(v.a,{value:s,label:"Username",required:!0,fullWidth:!0,autoFocus:!0,onChange:function(e){i(e.target.value)},error:Boolean(A.username),helperText:A.username?A.username:""})}),Object(r.jsx)(m.a,{item:!0,xs:12,children:Object(r.jsx)(v.a,{value:j,label:"Name",required:!0,fullWidth:!0,onChange:function(e){d(e.target.value)}})}),Object(r.jsx)(m.a,{item:!0,xs:12,children:Object(r.jsx)(v.a,{value:T,label:"E-mail Address",required:!0,fullWidth:!0,onChange:function(e){I(e.target.value)},error:Boolean(A.email),helperText:A.email?A.email:""})}),Object(r.jsx)(m.a,{item:!0,xs:12,children:Object(r.jsx)(v.a,{value:x,type:"password",label:"Password",required:!0,fullWidth:!0,onChange:function(e){g(e.target.value)},error:Boolean(A.password),helperText:A.password?A.password:""})})]}),Object(r.jsx)(m.a,{container:!0,justify:"center",children:Object(r.jsx)(m.a,{item:!0,children:Object(r.jsx)(S.a,{type:"submit",variant:"contained",color:"primary",size:"large",className:L.mainButton,disableElevation:!0,children:"Create"})})})]})}),Object(r.jsx)("div",{children:Object(r.jsx)(y.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:R,autoHideDuration:3e3,onClose:P,children:Object(r.jsx)(h.a,{onClose:P,severity:"error",children:"Please make sure all inputs are valid."})})})]})},k=n(19),T=n.n(k),I=n(23),z=n(30),B=n.n(z),R={create:function(){var e=Object(I.a)(T.a.mark((function e(t){var n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.post("/register",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},U=function(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(""),i=Object(o.a)(s,2),u=i[0],l=i[1],d=Object(j.g)(),b=f();return Object(r.jsxs)(m.a,{container:!0,className:b.root,children:[Object(r.jsx)(O.a,{}),Object(r.jsx)(m.a,{item:!0,xs:!1,sm:4,md:7,className:b.image}),Object(r.jsxs)(m.a,{item:!0,xs:12,sm:8,md:5,children:[n&&Object(r.jsx)(h.a,{severity:"success",children:n}),u&&Object(r.jsx)(h.a,{severity:"error",children:u}),Object(r.jsx)(N,{createUser:function(e){R.create(e).then((function(e){a("Registration Successful! Welcome ".concat(e.name)),window.localStorage.setItem("userAuthenticated",JSON.stringify(e)),d.push("/messenger")})).catch((function(e){l("Something went wrong on our side. Please try again later")}))}})]})]})},D=function(){var e=f(),t=Object(j.g)();return Object(r.jsx)("div",{className:e.loginRegisterRedirect,children:Object(r.jsxs)(m.a,{container:!0,justify:"flex-end",spacing:2,children:[Object(r.jsx)(m.a,{item:!0,children:Object(r.jsx)(w.a,{className:e.loginRedirectText,variant:"subtitle1",children:"Don't have an account?"})}),Object(r.jsx)(m.a,{item:!0,children:Object(r.jsx)(S.a,{type:"button",variant:"contained",color:"secondary",size:"large",className:e.secondaryButton,onClick:function(){t.push("/register")},children:"Create"})})]})})},E=function(e){var t=e.loginUser,n=Object(c.useState)(""),a=Object(o.a)(n,2),s=a[0],i=a[1],u=Object(c.useState)(""),l=Object(o.a)(u,2),j=l[0],d=l[1],b=f();return Object(r.jsxs)("div",{className:b.paper,children:[Object(r.jsx)(D,{}),Object(r.jsx)(m.a,{container:!0,alignContent:"flex-start",children:Object(r.jsx)(w.a,{component:"h1",variant:"h5",children:"Welcome Back!"})}),Object(r.jsx)("div",{children:Object(r.jsxs)("form",{className:b.form,onSubmit:function(e){e.preventDefault(),t({email:s,password:j}),i(""),d("")},children:[Object(r.jsxs)(m.a,{container:!0,spacing:2,children:[Object(r.jsx)(m.a,{item:!0,xs:12,children:Object(r.jsx)(v.a,{value:s,label:"E-mail",required:!0,fullWidth:!0,autoFocus:!0,onChange:function(e){i(e.target.value)}})}),Object(r.jsx)(m.a,{item:!0,xs:12,children:Object(r.jsx)(v.a,{value:j,type:"password",label:"Password",required:!0,fullWidth:!0,onChange:function(e){d(e.target.value)}})}),Object(r.jsx)(m.a,{})]}),Object(r.jsx)(m.a,{container:!0,justify:"center",children:Object(r.jsx)(m.a,{item:!0,children:Object(r.jsx)(S.a,{type:"submit",variant:"contained",color:"primary",size:"large",className:b.mainButton,disableElevation:!0,children:"Login"})})})]})})]})},A={login:function(){var e=Object(I.a)(T.a.mark((function e(t){var n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.post("/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},W=function(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(""),i=Object(o.a)(s,2),u=i[0],l=i[1],d=Object(j.g)(),b=f();return Object(r.jsxs)(m.a,{container:!0,className:b.root,children:[Object(r.jsx)(O.a,{}),Object(r.jsx)(m.a,{item:!0,xs:!1,sm:4,md:7,className:b.image}),Object(r.jsxs)(m.a,{item:!0,xs:12,sm:8,md:5,children:[n&&Object(r.jsx)(h.a,{severity:"success",children:n}),u&&Object(r.jsx)(h.a,{severity:"error",children:u}),Object(r.jsx)(E,{loginUser:function(e){A.login(e).then((function(e){a("Login Successful! Redirecting to messager app"),window.localStorage.setItem("userAuthenticated",JSON.stringify(e)),d.push("/messenger")})).catch((function(e){l("Invalid Username or Password"),setTimeout((function(){l(null)}),5e3)}))}})]})]})},L=n(64),P=n(109),q=n.n(P),J=Object(x.a)((function(e){return{root:{height:"100vh",width:"100vh",display:"flex",margin:e.spacing(2,2)},userList:{flexDirection:"column"},paper:{margin:e.spacing(10,8),display:"flex",flexDirection:"column"},messageBox:{height:"90vh"},chatInput:{display:"flex",flexDirection:"horizontal",alignItems:"center"},form:{width:"100%",marginTop:e.spacing(3)}}})),F=function(e){var t=e.messages,n=e.text,a=e.setText,c=e.sendMessage,s=J();return Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{className:s.messageBox,children:t.map((function(e,t){return Object(r.jsxs)("div",{children:[Object(r.jsxs)("b",{children:[e.sender,":"]})," ",e.text]},t)}))}),Object(r.jsx)("div",{children:Object(r.jsxs)("form",{autoComplete:"off",className:s.chatInput,onSubmit:c,children:[Object(r.jsx)(v.a,{value:n,fullWidth:!0,autoFocus:!0,onChange:function(e){e.preventDefault(),a(e.target.value)},onKeyPress:function(e){return"Enter"===e.key?c(e):null}}),Object(r.jsx)(S.a,{disabled:""===n.trim(),type:"button",onClick:c,variant:"contained",color:"primary",size:"large",disableElevation:!0,children:"Send"})]})})]})},M=function(e){var t=e.setUser,n=Object(j.g)();return Object(r.jsx)(S.a,{type:"button",variant:"contained",color:"primary",onClick:function(e){window.localStorage.removeItem("userAuthenticated"),n.push("/register"),t(null)},children:"LogOut"})},Z=n(220),H=n(221),K=function(e){var t=e.username;return Object(r.jsx)(Z.a,{children:Object(r.jsx)(H.a,{children:Object(r.jsx)(w.a,{children:t})})})},Y=function(e){var t=e.users,n=e.filterUser,a=e.startConversation,c=J();return Object(r.jsx)(m.a,{container:!0,direction:"column",className:c.userList,children:t?t.reduce((function(e,t){return t.username.includes(n)?[].concat(Object(L.a)(e),[Object(r.jsx)(m.a,{item:!0,onClick:function(){return a(t)},children:Object(r.jsx)(K,{username:t.username})},t.id)]):e}),[]):null})},$=function(e){var t=e.name,n=e.handler;return Object(r.jsxs)("div",{children:[Object(r.jsx)(w.a,{variant:"h4",children:"Chats"}),Object(r.jsx)(v.a,{label:"Search",variant:"filled",value:t,onChange:n})]})},_=function(e){var t=e.users,n=e.startConversation,a=Object(c.useState)(""),s=Object(o.a)(a,2),i=s[0],u=s[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)($,{name:i,handler:function(e){u(e.target.value)}}),Object(r.jsx)(Y,{users:t,filterUser:i,startConversation:n})]})},G={getUsers:function(){var e=Object(I.a)(T.a.mark((function e(t){var n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.post("/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Q={createConversation:function(){var e=Object(I.a)(T.a.mark((function e(t){var n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.post("/messages",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){"bearer ".concat(e)}},V=function(){var e=Object(j.g)(),t=J(),n=Object(c.useState)(""),s=Object(o.a)(n,2),i=s[0],u=s[1],l=Object(c.useState)(!1),d=Object(o.a)(l,2),b=d[0],h=d[1],x=Object(c.useState)(null),g=Object(o.a)(x,2),f=g[0],p=g[1],v=Object(c.useState)([]),y=Object(o.a)(v,2),w=y[0],S=y[1],C=Object(c.useState)(""),N=Object(o.a)(C,2),k=N[0],z=N[1],B=Object(c.useState)([]),R=Object(o.a)(B,2),U=R[0],D=R[1];Object(c.useEffect)((function(){a=q()();var t=window.localStorage.getItem("userAuthenticated");if(t){var n=JSON.parse(t);p(n),G.getUsers({username:n.username}).then((function(e){return S(e)}))}else alert("You must be logged in"),e.push("/login")}),[e]);var E=function(){var e=Object(I.a)(T.a.mark((function e(t){var n,r,c;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D([]),n={usernames:[f.username,t.username]},e.next=4,Q.createConversation(n);case 4:r=e.sent,h(!0),u(r.id),r.messages&&D(r.messages),c={user:f.username,target:t.username,id:r.id},a.emit("join",c);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){a.on("message",(function(e){D((function(t){return[].concat(Object(L.a)(t),[e])}))}))}),[]);return Object(r.jsxs)(m.a,{container:!0,direction:"row",spacing:2,className:t.root,children:[Object(r.jsx)(O.a,{}),Object(r.jsx)(m.a,{item:!0,xd:3,children:Object(r.jsx)(_,{users:w,currentUser:f,startConversation:E})}),Object(r.jsx)(m.a,{item:!0,xs:6,children:b?Object(r.jsx)(F,{messages:U,text:k,setText:z,sendMessage:function(e){e.preventDefault();var t=k.trim(),n={sender:f.username,text:t};n&&a.emit("sendMessage",{currentConversationID:i,msg:n},(function(){return z("")})),z("")}}):null}),Object(r.jsx)(m.a,{item:!0,xs:1,children:Object(r.jsx)(M,{setUser:p})})]})},X=(n(177),function(){var e=Object(c.useState)(null),t=Object(o.a)(e,2),n=t[0],a=t[1];return Object(c.useEffect)((function(){var e=window.localStorage.getItem("userAuthenticated");if(e){var t=JSON.parse(e);a(t),Q.setToken(t.token)}}),[]),Object(r.jsx)(u.a,{theme:b,children:Object(r.jsx)(l.a,{children:Object(r.jsxs)(j.d,{children:[Object(r.jsx)(j.b,{path:"/register",component:U}),Object(r.jsx)(j.b,{path:"/login",component:W}),Object(r.jsx)(j.b,{path:"/messenger",children:Object(r.jsx)(V,{})}),Object(r.jsx)(j.b,{path:"/",children:n?Object(r.jsx)(j.a,{to:"/messenger"}):Object(r.jsx)(U,{})})]})})})});i.a.render(Object(r.jsx)(X,{}),document.getElementById("root"))}},[[178,1,2]]]);
//# sourceMappingURL=main.1b9d3764.chunk.js.map