(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{148:function(e,t,n){},201:function(e,t,n){},202:function(e,t,n){"use strict";n.r(t);var a,r=n(2),c=n(0),s=n(10),i=n.n(s),o=(n(148),n(11)),l=n(247),u=n(37),j=n(13),d=n(131),b=Object(d.a)({typography:{fontFamily:"Open Sans",fontSize:16},palette:{primary:{main:"#1976d2"},secondary:{main:"#fff",contrastText:"#1976d2"}}}),m=n(238),h=n(250),x=n(236),O=n.p+"static/media/bg-img.0c5628a9.png",g=Object(x.a)((function(e){return{root:{height:"100vh"},paper:{marginTop:"15%",marginLeft:"15%",marginRight:"15%",display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"100%",marginTop:e.spacing(3)},image:{background:"linear-gradient(180deg, rgba(58, 141, 255, 0.85), rgba(134, 185, 255, 0.85)), url(".concat(O,")"),backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center"},mainButton:{margin:e.spacing(7,0,2),padding:e.spacing(1,3)},secondaryButton:{margin:e.spacing(1,0,0),padding:e.spacing(1,2)},loginRegisterRedirect:{marginBottom:e.spacing(5),display:"flex",flexDirection:"horizontal",alignItems:"end",width:"100%"},loginRedirectText:{marginTop:e.spacing(2),color:"lightgrey"},backgroundImageText:{padding:e.spacing(0,"15%")}}})),f=n(79),p=n.n(f),v=n(132),y=n(248),w=n(253),S=n(63),C=n(240),N=function(){var e=g(),t=Object(j.g)();return Object(r.jsx)("div",{className:e.loginRegisterRedirect,children:Object(r.jsxs)(m.a,{container:!0,justify:"flex-end",spacing:2,children:[Object(r.jsx)(m.a,{item:!0,children:Object(r.jsx)(S.a,{className:e.loginRedirectText,variant:"subtitle1",children:"Already have an account?"})}),Object(r.jsx)(m.a,{item:!0,children:Object(r.jsx)(C.a,{type:"button",variant:"contained",color:"secondary",size:"large",className:e.secondaryButton,onClick:function(){t.push("/login")},children:Object(r.jsx)("b",{children:"Login"})})})]})})},k=function(e){var t=e.createUser,n=Object(c.useState)(""),a=Object(o.a)(n,2),s=a[0],i=a[1],l=Object(c.useState)(""),u=Object(o.a)(l,2),j=u[0],d=u[1],b=Object(c.useState)(""),x=Object(o.a)(b,2),O=x[0],f=x[1],p=Object(c.useState)(""),k=Object(o.a)(p,2),I=k[0],T=k[1],B=Object(c.useState)(!1),z=Object(o.a)(B,2),R=z[0],U=z[1],D=Object(c.useState)({}),A=Object(o.a)(D,2),E=A[0],W=A[1],P=g(),L=function(e,t){"clickaway"!==t&&U(!1)};return Object(r.jsxs)("div",{className:P.paper,children:[Object(r.jsx)(N,{}),Object(r.jsx)(m.a,{container:!0,alignContent:"flex-start",children:Object(r.jsx)(S.a,{component:"h1",variant:"h4",children:Object(r.jsx)("b",{children:"Create an account"})})}),Object(r.jsxs)("form",{className:P.form,onSubmit:function(e){e.preventDefault(),!function(){var e={};return e.username=s.length>2?"":"Minimum of 3 characters",e.password=O.length>5?"":"Minimum of 6 characters",e.email=/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9]+\.[A-Za-z]+$/.test(I)?"":"Email Format is xyz@xxx.xxx",W(Object(v.a)({},e)),Object.values(e).every((function(e){return""===e}))}()?U(!0):(t({username:s,name:j,email:I,password:O}),U(!1),i(""),d(""),T(""),f(""))},children:[Object(r.jsxs)(m.a,{container:!0,spacing:2,children:[Object(r.jsx)(m.a,{item:!0,xs:12,children:Object(r.jsx)(y.a,{value:s,label:"Username",required:!0,fullWidth:!0,autoFocus:!0,onChange:function(e){i(e.target.value)},error:Boolean(E.username),helperText:E.username?E.username:""})}),Object(r.jsx)(m.a,{item:!0,xs:12,children:Object(r.jsx)(y.a,{value:j,label:"Name",required:!0,fullWidth:!0,onChange:function(e){d(e.target.value)}})}),Object(r.jsx)(m.a,{item:!0,xs:12,children:Object(r.jsx)(y.a,{value:I,label:"E-mail Address",required:!0,fullWidth:!0,onChange:function(e){T(e.target.value)},error:Boolean(E.email),helperText:E.email?E.email:""})}),Object(r.jsx)(m.a,{item:!0,xs:12,children:Object(r.jsx)(y.a,{value:O,type:"password",label:"Password",required:!0,fullWidth:!0,onChange:function(e){f(e.target.value)},error:Boolean(E.password),helperText:E.password?E.password:""})})]}),Object(r.jsx)(m.a,{container:!0,justify:"center",children:Object(r.jsx)(m.a,{item:!0,children:Object(r.jsx)(C.a,{type:"submit",variant:"contained",color:"primary",size:"large",className:P.mainButton,disableElevation:!0,children:Object(r.jsx)("b",{children:"Create"})})})})]}),Object(r.jsx)("div",{children:Object(r.jsx)(w.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:R,autoHideDuration:3e3,onClose:L,children:Object(r.jsx)(h.a,{onClose:L,severity:"error",children:"Please make sure all inputs are valid."})})})]})},I=n(19),T=n.n(I),B=n(28),z=n(42),R=n.n(z),U={create:function(){var e=Object(B.a)(T.a.mark((function e(t){var n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.a.post("/register",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},D=n(249),A=function(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(""),i=Object(o.a)(s,2),l=i[0],u=i[1],d=Object(j.g)(),b=g();return Object(r.jsxs)(m.a,{container:!0,className:b.root,children:[Object(r.jsx)(m.a,{component:D.a,xs:!1,sm:5,className:b.image,display:{xs:"none",sm:"block"},children:Object(r.jsxs)(D.a,{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",children:[Object(r.jsx)(p.a,{className:b.backgroundImageText,color:"secondary",style:{fontSize:"90"}}),Object(r.jsx)("br",{}),Object(r.jsx)(S.a,{className:b.backgroundImageText,variant:"h4",color:"secondary",align:"center",children:Object(r.jsx)(D.a,{letterSpacing:2,lineHeight:1.5,children:"Converse with anyone at any moment"})})]})}),Object(r.jsxs)(m.a,{item:!0,xs:12,sm:7,children:[n&&Object(r.jsx)(h.a,{severity:"success",children:n}),l&&Object(r.jsx)(h.a,{severity:"error",children:l}),Object(r.jsx)(k,{createUser:function(e){U.create(e).then((function(e){a("Registration Successful! Welcome ".concat(e.name)),window.localStorage.setItem("userAuthenticated",JSON.stringify(e)),d.push("/messenger")})).catch((function(e){u("Something went wrong on our side. Please try again later")}))}})]})]})},E=function(){var e=g(),t=Object(j.g)();return Object(r.jsx)("div",{className:e.loginRegisterRedirect,children:Object(r.jsxs)(m.a,{container:!0,justify:"flex-end",spacing:2,children:[Object(r.jsx)(m.a,{item:!0,children:Object(r.jsx)(S.a,{className:e.loginRedirectText,variant:"subtitle1",children:"Don't have an account?"})}),Object(r.jsx)(m.a,{item:!0,children:Object(r.jsx)(C.a,{type:"button",variant:"contained",color:"secondary",size:"large",className:e.secondaryButton,onClick:function(){t.push("/register")},children:Object(r.jsx)("b",{children:"Create"})})})]})})},W=function(e){var t=e.loginUser,n=Object(c.useState)(""),a=Object(o.a)(n,2),s=a[0],i=a[1],l=Object(c.useState)(""),u=Object(o.a)(l,2),j=u[0],d=u[1],b=g();return Object(r.jsxs)("div",{className:b.paper,children:[Object(r.jsx)(E,{}),Object(r.jsx)(m.a,{container:!0,alignContent:"flex-start",children:Object(r.jsx)(S.a,{component:"h1",variant:"h4",fontWeight:"fontWeightBold",children:Object(r.jsx)("b",{children:"Welcome Back!"})})}),Object(r.jsxs)("form",{className:b.form,onSubmit:function(e){e.preventDefault(),t({email:s,password:j}),i(""),d("")},children:[Object(r.jsxs)(m.a,{container:!0,spacing:2,children:[Object(r.jsx)(m.a,{item:!0,xs:12,children:Object(r.jsx)(y.a,{value:s,label:"E-mail",required:!0,fullWidth:!0,autoFocus:!0,onChange:function(e){i(e.target.value)}})}),Object(r.jsx)(m.a,{item:!0,xs:12,children:Object(r.jsx)(y.a,{value:j,type:"password",label:"Password",required:!0,fullWidth:!0,onChange:function(e){d(e.target.value)}})})]}),Object(r.jsx)(m.a,{container:!0,justify:"center",children:Object(r.jsx)(m.a,{item:!0,children:Object(r.jsx)(C.a,{type:"submit",variant:"contained",color:"primary",size:"large",className:b.mainButton,disableElevation:!0,children:Object(r.jsx)("b",{children:"Login"})})})})]})]})},P={login:function(){var e=Object(B.a)(T.a.mark((function e(t){var n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.a.post("/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},L=function(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(""),i=Object(o.a)(s,2),l=i[0],u=i[1],d=Object(j.g)(),b=g();return Object(r.jsxs)(m.a,{container:!0,className:b.root,children:[Object(r.jsx)(m.a,{component:D.a,xs:!1,sm:5,className:b.image,display:{xs:"none",sm:"block"},children:Object(r.jsxs)(D.a,{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",children:[Object(r.jsx)(p.a,{className:b.backgroundImageText,color:"secondary",style:{fontSize:"90"}}),Object(r.jsx)("br",{}),Object(r.jsx)(S.a,{className:b.backgroundImageText,variant:"h4",color:"secondary",align:"center",children:Object(r.jsx)(D.a,{letterSpacing:2,lineHeight:1.5,children:"Converse with anyone at any moment"})})]})}),Object(r.jsxs)(m.a,{item:!0,xs:12,sm:7,children:[n&&Object(r.jsx)(h.a,{severity:"success",children:n}),l&&Object(r.jsx)(h.a,{severity:"error",children:l}),Object(r.jsx)(W,{loginUser:function(e){P.login(e).then((function(e){a("Login Successful! Redirecting to messager app"),window.localStorage.setItem("userAuthenticated",JSON.stringify(e)),d.push("/messenger")})).catch((function(e){u("Invalid Username or Password"),setTimeout((function(){u(null)}),5e3)}))}})]})]})},q=n(80),J=n(128),F=n.n(J),M=Object(x.a)((function(e){return{root:{display:"flex"},userListItem:{width:"100%"},messageBox:{height:"85vh"},chatInput:{display:"flex",flexDirection:"horizontal",alignItems:"center"},form:{width:"100%",marginTop:e.spacing(3)},drawer:{width:280,flexShrink:0},drawerPaper:{width:280},searchBarContainer:{margin:e.spacing(0,2,2,2)},contentRight:{flexGrow:1,padding:e.spacing(3)}}})),H=n(204),Z=function(e){var t=e.messages,n=e.text,a=e.setText,c=e.sendMessage,s=M();return Object(r.jsxs)(H.a,{children:[Object(r.jsx)("div",{className:s.messageBox,children:t.map((function(e,t){return Object(r.jsxs)("div",{children:[Object(r.jsxs)("b",{children:[e.sender,":"]})," ",e.text]},t)}))}),Object(r.jsx)("div",{children:Object(r.jsxs)("form",{autoComplete:"off",className:s.chatInput,onSubmit:c,children:[Object(r.jsx)(y.a,{value:n,variant:"outlined",fullWidth:!0,autoFocus:!0,onChange:function(e){e.preventDefault(),a(e.target.value)},onKeyPress:function(e){return"Enter"===e.key?c(e):null}}),Object(r.jsx)(C.a,{disabled:""===n.trim(),type:"button",onClick:c,variant:"contained",color:"primary",size:"large",disableElevation:!0,children:"Send"})]})})]})},G=function(e){var t=e.setUser,n=Object(j.g)();return Object(r.jsx)(C.a,{type:"button",variant:"contained",color:"primary",onClick:function(e){window.localStorage.removeItem("userAuthenticated"),n.push("/register"),t(null)},children:"LogOut"})},K=n(243),Y=n(244),$=n(254),_=function(e){var t=e.username,n=M();return Object(r.jsx)(K.a,{className:n.userListItem,children:Object(r.jsx)(Y.a,{avatar:Object(r.jsx)($.a,{"aria-label":"users",children:t.substring(0,1)}),title:Object(r.jsx)("b",{children:t})})})},Q=n(245),V=n(242),X=function(e){var t=e.users,n=e.filterUser,a=e.startConversation;return Object(r.jsx)(V.a,{children:t?t.reduce((function(e,t){return t.username.includes(n)?[].concat(Object(q.a)(e),[Object(r.jsx)(Q.a,{onClick:function(){return a(t)},children:Object(r.jsx)(_,{username:t.username})},t.id)]):e}),[]):null})},ee=n(246),te=n(129),ne=n.n(te),ae=function(e){var t=e.name,n=e.handler,a=M();return Object(r.jsxs)("div",{className:a.searchBarContainer,children:[Object(r.jsx)(S.a,{variant:"h4",style:{marginBottom:10},children:"Chats"}),Object(r.jsx)(y.a,{label:"Search",variant:"filled",value:t,onChange:n,color:"primary",style:{background:"rgba(122, 188, 255, 0.3)"},InputProps:{startAdornment:Object(r.jsx)(ee.a,{position:"start",children:Object(r.jsx)(ne.a,{})})}})]})},re=function(e){var t=e.users,n=e.startConversation,a=Object(c.useState)(""),s=Object(o.a)(a,2),i=s[0],l=s[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)(ae,{name:i,handler:function(e){l(e.target.value)}}),Object(r.jsx)(X,{users:t,filterUser:i,startConversation:n})]})},ce={getUsers:function(){var e=Object(B.a)(T.a.mark((function e(t){var n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.a.post("/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},se={createConversation:function(){var e=Object(B.a)(T.a.mark((function e(t){var n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.a.post("/messages",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){"bearer ".concat(e)}},ie=n(130),oe=n.n(ie),le=function(e){var t=e.currentUser;return Object(r.jsxs)(D.a,{display:"flex",alignItems:"center",flexDirection:"row",style:{width:"100%",margin:20},children:[Object(r.jsx)($.a,{style:{marginLeft:5,marginRight:10}}),Object(r.jsx)(S.a,{children:t?t.username:"None"}),Object(r.jsx)(C.a,{size:"small",startIcon:Object(r.jsx)(oe.a,{})})]})},ue=n(252),je=function(){var e=Object(j.g)(),t=M(),n=Object(c.useState)(""),s=Object(o.a)(n,2),i=s[0],l=s[1],u=Object(c.useState)(!1),d=Object(o.a)(u,2),b=d[0],m=d[1],h=Object(c.useState)(null),x=Object(o.a)(h,2),O=x[0],g=x[1],f=Object(c.useState)([]),p=Object(o.a)(f,2),v=p[0],y=p[1],w=Object(c.useState)(""),S=Object(o.a)(w,2),C=S[0],N=S[1],k=Object(c.useState)([]),I=Object(o.a)(k,2),z=I[0],R=I[1];Object(c.useEffect)((function(){a=F()();var t=window.localStorage.getItem("userAuthenticated");if(t){var n=JSON.parse(t);g(n),ce.getUsers({username:n.username}).then((function(e){return y(e)}))}else alert("You must be logged in"),e.push("/login")}),[e]);var U=function(){var e=Object(B.a)(T.a.mark((function e(t){var n,r,c;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R([]),n={usernames:[O.username,t.username]},e.next=4,se.createConversation(n);case 4:r=e.sent,m(!0),l(r.id),r.messages&&R(r.messages),c={user:O.username,target:t.username,id:r.id},a.emit("join",c);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){a.on("message",(function(e){R((function(t){return[].concat(Object(q.a)(t),[e])}))}))}),[]);return Object(r.jsxs)("div",{className:t.root,children:[Object(r.jsx)("nav",{className:t.drawer,children:Object(r.jsxs)(ue.a,{variant:"permanent",anchor:"left",classes:{paper:t.drawerPaper},children:[Object(r.jsx)(le,{currentUser:O}),Object(r.jsx)(re,{users:v,currentUser:O,startConversation:U})]})}),Object(r.jsxs)("div",{borderTop:1,className:t.contentRight,children:[Object(r.jsx)(G,{setUser:g}),b?Object(r.jsx)(Z,{messages:z,text:C,setText:N,sendMessage:function(e){e.preventDefault();var t=C.trim(),n={sender:O.username,text:t};n&&a.emit("sendMessage",{currentConversationID:i,msg:n},(function(){return N("")})),N("")}}):null]})]})},de=(n(201),function(){var e=Object(c.useState)(null),t=Object(o.a)(e,2),n=t[0],a=t[1];return Object(c.useEffect)((function(){var e=window.localStorage.getItem("userAuthenticated");if(e){var t=JSON.parse(e);a(t),se.setToken(t.token)}}),[]),Object(r.jsx)(l.a,{theme:b,children:Object(r.jsx)(u.a,{children:Object(r.jsxs)(j.d,{children:[Object(r.jsx)(j.b,{path:"/register",component:A}),Object(r.jsx)(j.b,{path:"/login",component:L}),Object(r.jsx)(j.b,{path:"/messenger",children:Object(r.jsx)(je,{})}),Object(r.jsx)(j.b,{path:"/",children:n?Object(r.jsx)(j.a,{to:"/messenger"}):Object(r.jsx)(A,{})})]})})})});i.a.render(Object(r.jsx)(de,{}),document.getElementById("root"))}},[[202,1,2]]]);
//# sourceMappingURL=main.be4d2ab7.chunk.js.map