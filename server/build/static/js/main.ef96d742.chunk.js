(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{189:function(e,t,n){},244:function(e,t,n){},245:function(e,t,n){"use strict";n.r(t);var a,r=n(2),c=n(0),s=n(14),i=n.n(s),o=(n(189),n(9)),l=n(320),u=n(54),j=n(17),d=n(168),b=Object(d.a)({typography:{fontFamily:"Open Sans",fontSize:18},palette:{primary:{main:"#1976d2"},secondary:{main:"#fff",contrastText:"#1976d2"}}}),h=n(306),m=n(326),x=n(304),O=n.p+"static/media/bg-img.0c5628a9.png",g=Object(x.a)((function(e){return{root:{height:"100vh"},paper:{marginTop:"15%",marginLeft:"15%",marginRight:"15%",display:"flex",flexDirection:"column",alignItems:"center"},form:{width:"100%",marginTop:e.spacing(3)},image:{background:"linear-gradient(180deg, rgba(58, 141, 255, 0.85), rgba(134, 185, 255, 0.85)), url(".concat(O,")"),backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center"},mainButton:{margin:e.spacing(7,0,2),padding:e.spacing(1,3)},secondaryButton:{margin:e.spacing(1,0,0),padding:e.spacing(1,2)},loginRegisterRedirect:{marginBottom:e.spacing(5),display:"flex",flexDirection:"horizontal",alignItems:"end",width:"100%"},loginRedirectText:{marginTop:e.spacing(2),color:"lightgrey"},backgroundImageText:{padding:e.spacing(0,"15%")}}})),f=n(105),p=n.n(f),v=n(86),y=n(322),w=n(330),S=n(109),C=n(308),k=function(){var e=g(),t=Object(j.g)();return Object(r.jsx)("div",{className:e.loginRegisterRedirect,children:Object(r.jsxs)(h.a,{container:!0,justify:"flex-end",spacing:2,children:[Object(r.jsx)(h.a,{item:!0,children:Object(r.jsx)(S.a,{className:e.loginRedirectText,variant:"subtitle1",children:"Already have an account?"})}),Object(r.jsx)(h.a,{item:!0,children:Object(r.jsx)(C.a,{type:"button",variant:"contained",color:"secondary",size:"large",className:e.secondaryButton,onClick:function(){t.push("/login")},children:Object(r.jsx)("b",{children:"Login"})})})]})})},N=function(e){var t=e.createUser,n=Object(c.useState)(""),a=Object(o.a)(n,2),s=a[0],i=a[1],l=Object(c.useState)(""),u=Object(o.a)(l,2),j=u[0],d=u[1],b=Object(c.useState)(""),x=Object(o.a)(b,2),O=x[0],f=x[1],p=Object(c.useState)(""),N=Object(o.a)(p,2),I=N[0],T=N[1],B=Object(c.useState)(!1),R=Object(o.a)(B,2),U=R[0],z=R[1],D=Object(c.useState)({}),A=Object(o.a)(D,2),E=A[0],P=A[1],W=g(),L=function(e,t){"clickaway"!==t&&z(!1)};return Object(r.jsxs)("div",{className:W.paper,children:[Object(r.jsx)(k,{}),Object(r.jsx)(h.a,{container:!0,alignContent:"flex-start",children:Object(r.jsx)(S.a,{component:"h1",variant:"h4",children:Object(r.jsx)("b",{children:"Create an account"})})}),Object(r.jsxs)("form",{className:W.form,onSubmit:function(e){e.preventDefault(),!function(){var e={};return e.username=s.length>2?"":"Minimum of 3 characters",e.password=O.length>5?"":"Minimum of 6 characters",e.email=/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9]+\.[A-Za-z]+$/.test(I)?"":"Email Format is xyz@xxx.xxx",P(Object(v.a)({},e)),Object.values(e).every((function(e){return""===e}))}()?z(!0):(t({username:s,name:j,email:I,password:O}),z(!1),i(""),d(""),T(""),f(""))},children:[Object(r.jsxs)(h.a,{container:!0,spacing:2,children:[Object(r.jsx)(h.a,{item:!0,xs:12,children:Object(r.jsx)(y.a,{value:s,label:"Username",required:!0,fullWidth:!0,autoFocus:!0,onChange:function(e){i(e.target.value)},error:Boolean(E.username),helperText:E.username?E.username:""})}),Object(r.jsx)(h.a,{item:!0,xs:12,children:Object(r.jsx)(y.a,{value:j,label:"Name",required:!0,fullWidth:!0,onChange:function(e){d(e.target.value)}})}),Object(r.jsx)(h.a,{item:!0,xs:12,children:Object(r.jsx)(y.a,{value:I,label:"E-mail Address",required:!0,fullWidth:!0,onChange:function(e){T(e.target.value)},error:Boolean(E.email),helperText:E.email?E.email:""})}),Object(r.jsx)(h.a,{item:!0,xs:12,children:Object(r.jsx)(y.a,{value:O,type:"password",label:"Password",required:!0,fullWidth:!0,onChange:function(e){f(e.target.value)},error:Boolean(E.password),helperText:E.password?E.password:""})})]}),Object(r.jsx)(h.a,{container:!0,justify:"center",children:Object(r.jsx)(h.a,{item:!0,children:Object(r.jsx)(C.a,{type:"submit",variant:"contained",color:"primary",size:"large",className:W.mainButton,disableElevation:!0,children:Object(r.jsx)("b",{children:"Create"})})})})]}),Object(r.jsx)("div",{children:Object(r.jsx)(w.a,{anchorOrigin:{vertical:"top",horizontal:"right"},open:U,autoHideDuration:3e3,onClose:L,children:Object(r.jsx)(m.a,{onClose:L,severity:"error",children:"Please make sure all inputs are valid."})})})]})},I=n(26),T=n.n(I),B=n(42),R=n(59),U=n.n(R),z={create:function(){var e=Object(B.a)(T.a.mark((function e(t){var n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.a.post("/register",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},D=n(323),A=function(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(""),i=Object(o.a)(s,2),l=i[0],u=i[1],d=Object(j.g)(),b=g();return Object(r.jsxs)(h.a,{container:!0,className:b.root,children:[Object(r.jsx)(h.a,{component:D.a,xs:!1,sm:5,className:b.image,display:{xs:"none",sm:"block"},children:Object(r.jsxs)(D.a,{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",children:[Object(r.jsx)(p.a,{className:b.backgroundImageText,color:"secondary",style:{fontSize:"90"}}),Object(r.jsx)("br",{}),Object(r.jsx)(S.a,{className:b.backgroundImageText,variant:"h4",color:"secondary",align:"center",children:Object(r.jsx)(D.a,{letterSpacing:2,lineHeight:1.5,children:"Converse with anyone at any moment"})})]})}),Object(r.jsxs)(h.a,{item:!0,xs:12,sm:7,children:[n&&Object(r.jsx)(m.a,{severity:"success",children:n}),l&&Object(r.jsx)(m.a,{severity:"error",children:l}),Object(r.jsx)(N,{createUser:function(e){z.create(e).then((function(e){a("Registration Successful! Welcome ".concat(e.name)),window.localStorage.setItem("userAuthenticated",JSON.stringify(e)),d.push("/messenger")})).catch((function(e){u("Something went wrong on our side. Please try again later")}))}})]})]})},E=function(){var e=g(),t=Object(j.g)();return Object(r.jsx)("div",{className:e.loginRegisterRedirect,children:Object(r.jsxs)(h.a,{container:!0,justify:"flex-end",spacing:2,children:[Object(r.jsx)(h.a,{item:!0,children:Object(r.jsx)(S.a,{className:e.loginRedirectText,variant:"subtitle1",children:"Don't have an account?"})}),Object(r.jsx)(h.a,{item:!0,children:Object(r.jsx)(C.a,{type:"button",variant:"contained",color:"secondary",size:"large",className:e.secondaryButton,onClick:function(){t.push("/register")},children:Object(r.jsx)("b",{children:"Create"})})})]})})},P=function(e){var t=e.loginUser,n=Object(c.useState)(""),a=Object(o.a)(n,2),s=a[0],i=a[1],l=Object(c.useState)(""),u=Object(o.a)(l,2),j=u[0],d=u[1],b=g();return Object(r.jsxs)("div",{className:b.paper,children:[Object(r.jsx)(E,{}),Object(r.jsx)(h.a,{container:!0,alignContent:"flex-start",children:Object(r.jsx)(S.a,{component:"h1",variant:"h4",fontWeight:"fontWeightBold",children:Object(r.jsx)("b",{children:"Welcome Back!"})})}),Object(r.jsxs)("form",{className:b.form,onSubmit:function(e){e.preventDefault(),t({email:s,password:j}),i(""),d("")},children:[Object(r.jsxs)(h.a,{container:!0,spacing:2,children:[Object(r.jsx)(h.a,{item:!0,xs:12,children:Object(r.jsx)(y.a,{value:s,label:"E-mail",required:!0,fullWidth:!0,autoFocus:!0,onChange:function(e){i(e.target.value)}})}),Object(r.jsx)(h.a,{item:!0,xs:12,children:Object(r.jsx)(y.a,{value:j,type:"password",label:"Password",required:!0,fullWidth:!0,onChange:function(e){d(e.target.value)}})})]}),Object(r.jsx)(h.a,{container:!0,justify:"center",children:Object(r.jsx)(h.a,{item:!0,children:Object(r.jsx)(C.a,{type:"submit",variant:"contained",color:"primary",size:"large",className:b.mainButton,disableElevation:!0,children:Object(r.jsx)("b",{children:"Login"})})})})]})]})},W={login:function(){var e=Object(B.a)(T.a.mark((function e(t){var n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.a.post("/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},L=function(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(""),i=Object(o.a)(s,2),l=i[0],u=i[1],d=Object(j.g)(),b=g();return Object(r.jsxs)(h.a,{container:!0,className:b.root,children:[Object(r.jsx)(h.a,{component:D.a,xs:!1,sm:5,className:b.image,display:{xs:"none",sm:"block"},children:Object(r.jsxs)(D.a,{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",children:[Object(r.jsx)(p.a,{className:b.backgroundImageText,color:"secondary",style:{fontSize:"90"}}),Object(r.jsx)("br",{}),Object(r.jsx)(S.a,{className:b.backgroundImageText,variant:"h4",color:"secondary",align:"center",children:Object(r.jsx)(D.a,{letterSpacing:2,lineHeight:1.5,children:"Converse with anyone at any moment"})})]})}),Object(r.jsxs)(h.a,{item:!0,xs:12,sm:7,children:[n&&Object(r.jsx)(m.a,{severity:"success",children:n}),l&&Object(r.jsx)(m.a,{severity:"error",children:l}),Object(r.jsx)(P,{loginUser:function(e){W.login(e).then((function(e){a("Login Successful! Redirecting to messager app"),window.localStorage.setItem("userAuthenticated",JSON.stringify(e)),d.push("/messenger")})).catch((function(e){u("Invalid Username or Password"),setTimeout((function(){u(null)}),5e3)}))}})]})]})},q=n(29),F=n(166),J=n.n(F),H=n(20),M=Object(x.a)((function(e){return{root:{display:"flex"},messageBox:{height:"85vh"},chatInput:{display:"flex",flexDirection:"horizontal",alignItems:"center"},form:{width:"100%",marginTop:e.spacing(3)},drawer:{width:400,flexShrink:0},drawerPaper:{width:400,overflowX:"hidden"},chatHeaderText:{margin:e.spacing(0,2,2,2)},searchBarContainer:{width:400,margin:e.spacing(0,2,2,2),backgroundColor:Object(H.c)(e.palette.primary.light,.25)},contentRight:{flexGrow:1,padding:e.spacing(3)},currentUserAvatarColor:{background:"linear-gradient(180deg, rgba(58, 141, 255, 0.85), rgba(134, 185, 255, 0.85))"}}})),Z=n(247),K=function(e){var t=e.messages,n=e.text,a=e.setText,c=e.sendMessage,s=M();return Object(r.jsxs)(Z.a,{children:[Object(r.jsx)("div",{className:s.messageBox,children:t.map((function(e,t){return Object(r.jsxs)("div",{children:[Object(r.jsxs)("b",{children:[e.sender,":"]})," ",e.text]},t)}))}),Object(r.jsx)("div",{children:Object(r.jsxs)("form",{autoComplete:"off",className:s.chatInput,onSubmit:c,children:[Object(r.jsx)(y.a,{value:n,variant:"outlined",fullWidth:!0,autoFocus:!0,onChange:function(e){e.preventDefault(),a(e.target.value)},onKeyPress:function(e){return"Enter"===e.key?c(e):null}}),Object(r.jsx)(C.a,{disabled:""===n.trim(),type:"button",onClick:c,variant:"contained",color:"primary",size:"large",disableElevation:!0,children:"Send"})]})})]})},G=n(312),X=n(313),Y=n(333),$=function(e){var t=e.username,n=function(e,t,n){for(var a=0,r=0;r<e.length;r++)a=e.charCodeAt(r)+((a<<5)-a);return"hsl(".concat(a%360,", ").concat(t,"%, ").concat(n,"%)")}(t,50,80),a=Object(x.a)((function(){return{userListItem:{width:"100%"},avatarColor:{background:"".concat(n),width:"50px",height:"50px"}}}))();return Object(r.jsx)(G.a,{className:a.userListItem,style:{height:"100px",paddingTop:"8px",borderBottom:"solid",borderWidth:"2px",borderBottomColor:"rgba(230, 230, 230, 0.5)",borderRadius:"2px",marginBottom:"-15px"},elevation:0,children:Object(r.jsx)(X.a,{avatar:Object(r.jsx)(Y.a,{className:a.avatarColor,"aria-label":"users",children:t.substring(0,1).toUpperCase()}),title:Object(r.jsx)("b",{children:t})})})},_=n(314),Q=n(310),V=function(e){var t=e.users,n=e.filterUser,a=e.startConversation;return Object(r.jsx)(Q.a,{children:t?t.reduce((function(e,t){return t.username.toLowerCase().includes(n.toLowerCase())?[].concat(Object(q.a)(e),[Object(r.jsx)(_.a,{onClick:function(){return a(t)},children:Object(r.jsx)($,{username:t.username})},t.id)]):e}),[]):null})},ee=n(311),te=n(332),ne=n(167),ae=n.n(ne),re=function(e){var t=e.name,n=e.handler;return Object(r.jsxs)(Z.a,{style:{background:"rgba(163, 198, 255, 0.3)",height:65,width:350,display:"flex",alignItems:"center",marginLeft:"16px"},sx:{height:300},elevation:0,children:[Object(r.jsx)(ee.a,{sx:{p:"10px"},"aria-label":"search",disabled:"true",children:Object(r.jsx)(ae.a,{})}),Object(r.jsx)(te.a,{placeholder:"Search",inputProps:{"aria-label":"Search"},value:t,onChange:n})]})},ce=function(e){var t=e.users,n=e.startConversation,a=Object(c.useState)(""),s=Object(o.a)(a,2),i=s[0],l=s[1],u=M();return Object(r.jsxs)("div",{children:[Object(r.jsx)(S.a,{className:u.chatHeaderText,variant:"h4",style:{marginBottom:10},children:"Chats"}),Object(r.jsx)(re,{name:i,handler:function(e){l(e.target.value)}}),Object(r.jsx)(V,{users:t,filterUser:i,startConversation:n})]})},se={getUsers:function(){var e=Object(B.a)(T.a.mark((function e(t){var n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.a.post("/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},ie={createConversation:function(){var e=Object(B.a)(T.a.mark((function e(t){var n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.a.post("/messages",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){"bearer ".concat(e)}},oe=n(107),le=n.n(oe),ue=n(331),je=n(318),de=n(336),be=n(337),he=n(321),me=n(328),xe=n(327),Oe=function(e){var t=e.setUser,n=Object(c.useState)(!1),a=Object(o.a)(n,2),s=a[0],i=a[1],l=Object(c.useRef)(null),u=function(e){i(!1)},d=function(e){"Tab"===e.key?(e.preventDefault(),i(!1)):"Escape"===e.key&&i(!1)},b=Object(j.g)(),h=function(e){window.localStorage.removeItem("userAuthenticated"),b.push("/register"),t(null)},m=Object(c.useRef)(s);return Object(c.useEffect)((function(){!0===m.current&&!1===s&&l.current.focus(),m.current=s}),[s]),Object(r.jsxs)("div",{children:[Object(r.jsx)(ue.a,{ref:l,onClick:function(){i((function(e){return!e}))},size:"large",startIcon:Object(r.jsx)(le.a,{})}),Object(r.jsx)(he.a,{open:s,anchorEl:l.current,placement:"bottom-start",transition:!0,disablePortal:!0,children:function(e){var t=e.TransitionProps,n=e.placement;return Object(r.jsx)(de.a,Object(v.a)(Object(v.a)({},t),{},{style:{transformOrigin:"bottom-start"===n?"left top":"left bottom"},children:Object(r.jsx)(be.a,{children:Object(r.jsx)(je.a,{onClickAway:u,children:Object(r.jsx)(xe.a,{autoFocusItem:s,onKeyDown:d,children:Object(r.jsx)(me.a,{onClick:h,children:"Logout"})})})})}))}})]})},ge=function(e){var t=e.currentUser,n=e.setUser,a=M();return Object(r.jsxs)(D.a,{display:"flex",alignItems:"center",flexDirection:"row",style:{width:"100%",margin:20},children:[Object(r.jsx)(Y.a,{className:a.currentUserAvatarColor,style:{width:"60px",height:"60px",marginLeft:5,marginRight:24}}),Object(r.jsx)(S.a,{style:{marginRight:6},children:Object(r.jsx)("b",{children:t?t.username:"None"})}),Object(r.jsx)(Oe,{size:"small",startIcon:Object(r.jsx)(le.a,{}),setUser:n})]})},fe=n(319),pe=n(329),ve=function(){var e=Object(j.g)(),t=M(),n=Object(c.useState)(""),s=Object(o.a)(n,2),i=s[0],l=s[1],u=Object(c.useState)(!1),d=Object(o.a)(u,2),b=d[0],h=d[1],m=Object(c.useState)(null),x=Object(o.a)(m,2),O=x[0],g=x[1],f=Object(c.useState)([]),p=Object(o.a)(f,2),v=p[0],y=p[1],w=Object(c.useState)(""),S=Object(o.a)(w,2),C=S[0],k=S[1],N=Object(c.useState)([]),I=Object(o.a)(N,2),R=I[0],U=I[1];Object(c.useEffect)((function(){a=J()();var t=window.localStorage.getItem("userAuthenticated");if(t){var n=JSON.parse(t);g(n),se.getUsers({username:n.username}).then((function(e){return y(e)}))}else alert("You must be logged in"),e.push("/login")}),[e]);var z=function(){var e=Object(B.a)(T.a.mark((function e(t){var n,r,c;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return U([]),n={usernames:[O.username,t.username]},e.next=4,ie.createConversation(n);case 4:r=e.sent,h(!0),l(r.id),r.messages&&U(r.messages),c={user:O.username,target:t.username,id:r.id},a.emit("join",c);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){a.on("message",(function(e){U((function(t){return[].concat(Object(q.a)(t),[e])}))}))}),[]);return Object(r.jsxs)("div",{className:t.root,children:[Object(r.jsx)(fe.a,{}),Object(r.jsx)("div",{className:t.drawer,children:Object(r.jsxs)(pe.a,{variant:"permanent",anchor:"left",classes:{paper:t.drawerPaper},children:[Object(r.jsx)(ge,{currentUser:O,setUser:g}),Object(r.jsx)(ce,{users:v,currentUser:O,startConversation:z})]})}),Object(r.jsx)("div",{bordertop:1,className:t.contentRight,children:b?Object(r.jsx)(K,{messages:R,text:C,setText:k,sendMessage:function(e){e.preventDefault();var t=C.trim(),n={sender:O.username,text:t};n&&a.emit("sendMessage",{currentConversationID:i,msg:n},(function(){return k("")})),k("")}}):null})]})},ye=(n(244),function(){var e=Object(c.useState)(null),t=Object(o.a)(e,2),n=t[0],a=t[1];return Object(c.useEffect)((function(){var e=window.localStorage.getItem("userAuthenticated");if(e){var t=JSON.parse(e);a(t),ie.setToken(t.token)}}),[]),Object(r.jsx)(l.a,{theme:b,children:Object(r.jsx)(u.a,{children:Object(r.jsxs)(j.d,{children:[Object(r.jsx)(j.b,{path:"/register",component:A}),Object(r.jsx)(j.b,{path:"/login",component:L}),Object(r.jsx)(j.b,{path:"/messenger",children:Object(r.jsx)(ve,{})}),Object(r.jsx)(j.b,{path:"/",children:n?Object(r.jsx)(j.a,{to:"/messenger"}):Object(r.jsx)(A,{})})]})})})});i.a.render(Object(r.jsx)(ye,{}),document.getElementById("root"))}},[[245,1,2]]]);
//# sourceMappingURL=main.ef96d742.chunk.js.map